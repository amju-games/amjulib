// terrain-vert.txt

uniform mat4 modelViewProjectionMatrix;
varying vec2 UV;
uniform sampler2D heightSampler;

void main()
{
  vec4 a = gl_Vertex;
  vec2 st = vec2((a.x + 10.0) / 20.0, (a.z + 10.0) / 20.0);
  float texel = texture2D(heightSampler, st).r;
  a.y = (0.5 - texel) * 4.0;

  UV = st;
 
  gl_Position = modelViewProjectionMatrix * a;
}
